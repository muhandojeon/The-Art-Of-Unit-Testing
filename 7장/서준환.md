테스트의 실패는 모두 **합당한 이유**가 있어야 한다.

그것은 실제 코드에 문제가 있을 때여야 한다.

테스트가 실패하는 이유들

- 프로덕션 코드의 실제 버그
- 테스트의 거짓 실패
- 기능 변경으로 테스트가 최신 상태가 아님
- 테스트가 다른 테스트와 충돌
- 테스트가 불안정함

### 테스트의 거짓 실패

> 테스트의 거짓 실패가 가장 찾기 어려운 것 같다.
>
> 보통 테스트 코드 작성할 때 잘못 작성했을리가 없다고 생각하기에 그냥 슥슥 넘어간다.

TDD를 하면 코드의 어떤 부분이 잘못 되었는지 쉽게 찾을 수 있다.  왜지?,,

### 테스트가 다른 테스트와 충돌하는 경우

> 여담이지만 회사에 프로덕트 오너가 있으신가요?,,

## 불필요한 로직

테스트 자체에 여러 로직을 넣으면 버그를 미연에 방지하기 위해 작성한 테스트 코드에 버그가 생길 수 있다.

switch, if, else, foreach, for, while, 문자열 연결, try / catch 등은 사용을 줄이거나 제거하는 것이 좋다.

> 테스트 작성하며 try / catch나 for, forEach의 경우 몇 번 사용했던 기억이 있는데 좋지 않은 것이었군요,,

더불어 동적 기댓값 생성을 통한 검증은 없어야 한다.


> 이전에 테스트 코드 작성하면서 되게 간지러웠던 부분이었는데, 여기서 제대로 알아가네요,,
> 
> “검증 단계에서 기댓값을 동적으로 생성하지 말고 가능하면 하드코딩된 값을 사용하라”
>
> “유지 보수성보다 신뢰성이 훨씬 더 중요하다”

더불어 테스트 코드 커버리지는 그 자체로 목표가 되어선 안 된다. 이는 불필요하고 의미 없는 테스트 코드를 작성하며, 유지 보수에 시간을 더 써야만 한다.

### 여러 가지를 한꺼번에 검증하는 경우

종료점은 나눠서 검증하는 것이 좋다.

사유로는 연달아 있는 검증은 첫번째에 위치한 검증이 실패했는지, 두번째인지 바로 확인이 불가능하다.

최대한 나눠서 작성하고, 동일한 관심사라면 예외적으로 함께 작성해도 괜찮다.

## 정리

- 테스트에서는 동적으로 결과 값을 생성하거나 프로덕션 코드의 로직을 다시금 사용하는 것은 좋지 않다.
- 검증 부분이 없는 테스트는 신뢰할 수 없다.
- e2e와 같은 테스트는 고수준으로, 실제 의존성이 많아지는데, 이로 인해 전체적인 검증을 통한 신뢰성은 높아지지만 불안정성도 함께 증가한다.
- 어떤 테스트인지 잘 이해할 수 있도록 이름, 종료점, 등등 여러가지를 잘 작성해보자.
