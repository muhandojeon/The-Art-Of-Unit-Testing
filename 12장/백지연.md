# 레거시 코드 다루기
레거시 코드를 작업할 때는 2가지 고민이 생긴다.
- 테스트를 어디에서부터 시작하고 어느 부분에 집중해야 할까?
- 테스트가 없는 상태에서 기존 기능을 망가뜨리지 않으면서 어떻게 안전하게 코드를 리팩터링 할 수 있을까?

## 어디에서부터 테스트를 시작해야 할까?
컴포넌트의 우선순위를 결정할 때 고려해야 할 3가지 항목이 있다.
- **논리적 복잡도** : 컴포넌트 내에 존재하는 논리 구조의 복잡성
  - 중첩 if문, switch문, 재귀 호출 등
- **의존성 수준** : 컴포넌트가 의존하는 외부 요소 수
  - 이메일 서비스/데이터베이스 같은 시스템에 연동되거나 정적 로그 메서드를 호출하는 경우
- **우선순위** : 컴포넌트가 프로젝트 내에서 차지하는 중요도

3가지 항목별로 점수를 매겨 테스트 가능성 표를 만들고, 어떤 항목부터 테스트할지 결정하면 된다.  
- 복잡 && 테스트하기 쉬운 항목
- 복잡 && 테스트하기 어려운 항목

## 무엇을 선택할지 결정
테스트하기 쉬운 것부터 시작할 수도 있고, 의존성이 많아 테스트하기 어려운 컴포넌트부터 시작할 수도 있다.  

### 쉬운 것부터 시작했을 때의 장단점
#### 장점
- 초기 테스트 작성이 훨씬 빠르고 수월하다.
- 테스트에 익숙하지 않다면 간단한 것부터 시작해서 역량을 키울 수 있다.

#### 단점
- 시간이 지날수록 테스트하기 어려운 컴포넌트들만 남는다.
- 제품 출시를 앞두고 스트레스를 받는 시점에 어려운 컴포넌트 테스트 일정이 잡힌다.

### 어려운 것부터 시작했을 때의 장단점
#### 장점
- 의존성이 많은 컴포넌트를 테스트하기 좋게 리팩터링하는 과정에서 테스트 작성 시간이 빠르게 줄어든다.

#### 단점
- 초기에는 테스트 작성 시간이 많이 걸린다.
- 팀원 개개인이 단위 테스트에 경험이 풍부할 때만 가능한 방법이다.

## 리팩터링 전에 통합 테스트 작성
리팩터링을 하더라도 기존 기능의 동작을 보장할 수 있도록 운영 시스템에 대한 통합 테스트를 미리 작성하는 것이 좋다.  
리팩터링이 끝난 후에는 통합 테스트를 더 작고 관리하기 쉬운 단위 테스트로 교체한다.
