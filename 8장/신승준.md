# 유지 보수성

프로덕션 코드를 변경할 때 기존 테스트를 수정할 필요가 없다면, 테스트가 개발에 실질적인 도움이 된다고 볼 수 있다.

> 사전 과제를 리팩토링해볼 때 이것의 이점을 많이 느꼈었어요.

## 테스트 실패로 코드 변경

### 거짓 실패(프로덕션 코드의 버그가 아닌 다른 이유로 발생하는 실패)

- 순서가 정해진 테스트: 테스트 러나가 테스트를 항상 특정 순서로 실행하지 않는다.

> 몰랐네요..! 비동기가 섞였을 때 순서대로 되지 않을 수도 있는 걸까요? vitest로 해봤을 때는 항상 같은 것 같아서...

- 필자는 코드 내에서 공유하는 변수나 함수 등 자원이 있을 때는 거의 항상 beforeEach나 afterEach에서 초기 상태로 리셋하는 편이다.

> 저는 되도록이면 beforeEach에서 초기화를 하려고 하는 편이에요. cypress 문서의 베스트 프렉티스에서 본 건데 afterEach는 테스트 실패 시 실행되지 않을 수도 있다고 해서요.

## 유지 보수성을 높이는 리팩터링 방법

### private 또는 protected 메서드 사용하지 않기

결국 중요한 점은 시스템의 외부 동작, 즉 public 메서드가 올바르게 작동하는지 확인하는 것이다. public 메서드로 private 메서드를 간접적으로 테스트하는 것이 더 효과적이다.

> 요즘 NestJS 코드를 작성하곤 하는데, 동료 개발자 분이 private을 되도록이면 쓰지 말자고 했었어요. 테스트하기 어려워진다고 하더라고요. 사알짝 이제 이해가 조금 되기도 하네요.
