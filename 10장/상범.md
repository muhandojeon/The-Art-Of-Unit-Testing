# 10장 더 나은 테스트 전략 수립

단위테스트가 팀 내 테스트 전략과 어떻게 맞물리는지 알아보는 챕터다~

## 일반적인 테스트 유형과 수준

![스크린샷 2025-04-05 오후 10 53 16](https://github.com/user-attachments/assets/198afe7a-6439-46c3-b7c8-064e5c431ea7)

- 단위 테스트와 컴포넌트 테스트는 유지 보수성, 실행 속도, 복잡성과 불안정성이 적다는 측면에서 가장 우수하지만,   
테스트가 통과되었을 때 얻을 수 있는 신뢰도 측면에서는 가장 약함.
- 통합 테스트와 API 테스트는 신뢰도와 다른 기준 사이에서 균형을 유지하는 중간 지점에 위치함
- E2E 테스트는 단위 테스트와 정반대의 접근 방식을 취하는데 유지 보수성, 실행 속도, 복잡성, 불안정성을 포기하는 대신 가장 높은 테스트 신뢰도를 자랑함

## 각 테스트 수준마다 존재하는 안티 패턴
e2e 테스트만으로 빌드를 구성하는 것은 E2E 테스트만 사용하는 안티 패턴임.   
=> 새롭게 작성하는 E2E 테스트의 가치는 적지만, 모든 테스트의 유지보수에 필요한 비용은 동일하게 들기 때문  

가장 중요한 기능만 확인하는 용도로 최소화하여 E2E 테스트를 사용하는 것이 가장 효율적이다!

> '책임 전가' 사고방식과 QA 팀과 별도로 운영하기 때문이라는 말과 '잘 되고 있으면 굳이 바꾸지 말자'는 마인드에 대해 언급했는데, 많이 뜨끔하면서 읽었다.   
> 실용주의 프로그래머에서 읽었던 콘웨이의 법칙이 생각나기도 했다

## 저수준 테스트만 사용하는 안티 패턴

이건 반대로 빌드를 단위 테스트나 컴포넌트 테스트만으로 구성하는 경우인데, 저수준 테스트만으로는 전체 기능이 제대로 동작하는지 충분히 확신하기 어려우므로 고수준 테스트도 함께 작성하는걸 강력히 추천한다고 한다!

## 테스트 레시피 전략

테스트 레시피: 특정 기능을 어떻게 테스트할지 간단한 계획을 세우는 것

- 이 계획에는 해피패스 뿐만 아니라, 예외적인 상황, 엣지 케이스도 모두 포함해야 됨
- 작성하기 가장 좋은 시점은 기능 작업 시작하기 직전임
- 시간이 지나면서 레시피가 바뀔 수 있음!
  - 레시피는 고정된 산출물이 아니라서, 소프트웨어 개발의 다른 모든 것처럼 계속해서 발전을 거듭하는 작업물임
- 고수준 테스트 하나 작성하면 저수준 테스트 한 다섯개, 열개 정도 비율을 유지하며 작성하는 식으로 짜는게 좋음
- 테스트 레시피를 너무 형식적으로 다룰 필요 없음

```
// 사용자 프로필 기능에 대한 테스트 레시피 예시

- E2E： 로그인, 프로필 화면으로 이동, 이메일 업데이트, 로그아웃, 새 이메일로 다시 로그인, 프로필 화면 업데이
트 확인
- API： 더 복잡한 데이터를 사용하여 UpdateProfile API 호출
- 단위 테스트: 잘못된 이메일로 프로필 업데이트 로직 확인
- 단위 테스트: 동일한 이메일로 프로필 업데이트 로직 확인
- 단위 테스트: 프로필 데이터 변환 및 데이터 복원 
```

테스트 작성 규칙을 따르면 대부분의 테스트가 저수준에서 실행되어 빠르게 결과를 얻을 수 있고,   
중요한 시나리오는 고수준 테스트로 커버할 수 있어서 신뢰도도 확보 할 수 있다.   
그리고 주요 시나리오는 고수준에서 테스트하고, 그 시나리오에서 파생된 테스트들은 저수준에서 진행하여 중복도 피할 수 있다.   
가장 중요한건 QA 팀과 테스트 레시피 작성하면서 새로운 소통 경로가 생기고 서로의 역할과 책임을 더 잘 이해 가능하다!   

